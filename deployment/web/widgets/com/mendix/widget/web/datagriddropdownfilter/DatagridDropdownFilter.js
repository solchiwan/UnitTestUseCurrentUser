define(["react","mendix/filters/builders"],(function(e,t){"use strict";var n,a,l=(function(e){
/*!
      Copyright (c) 2017 Jed Watson.
      Licensed under the MIT License (MIT), see
      http://jedwatson.github.io/classnames
    */
!function(){var t={}.hasOwnProperty;function n(){for(var e=[],a=0;a<arguments.length;a++){var l=arguments[a];if(l){var i=typeof l;if("string"===i||"number"===i)e.push(l);else if(Array.isArray(l)&&l.length){var o=n.apply(null,l);o&&e.push(o)}else if("object"===i)for(var r in l)t.call(l,r)&&l[r]&&e.push(r)}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n}()}(a={path:n,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&a.path)}},a.exports),a.exports);const i=({className:t,bootstrapStyle:n,children:a})=>e.Children.count(a)>0?e.createElement("div",{className:l("alert alert-".concat(n),t)},a):null;var o;function r(t){var n;const[a,i]=e.useState(""),[o,r]=e.useState([]),[u,c]=e.useState([]),[d,s]=e.useState(!1),[p,v]=e.useState(0),m=e.useRef(null),f=e.useCallback((e=>{var n;0===(null==e?void 0:e.length)?(i(null!==(n=t.emptyOptionCaption)&&void 0!==n?n:""),c([])):(i(e.map((e=>e.caption)).join(",")),c(e))}),[t.emptyOptionCaption]),h=e.useCallback((e=>{t.multiSelect?f(function(e,t){const n=[...e],a=e.indexOf(t);a>-1?n.splice(a,1):n.push(t);return n}(u,e)):(i(e.caption),c([e]),s(!1))}),[u,t.emptyOptionCaption,t.multiSelect]);var b,y;b=m,y=()=>s(!1),e.useEffect((()=>{const e=e=>{b.current&&!b.current.contains(e.target)&&y()};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[b,y]);const g=e.useMemo((()=>{var e,n,a;return t.auto?null!==(a=null===(n=null===(e=t.attribute)||void 0===e?void 0:e.universe)||void 0===n?void 0:n.map((e=>{var n,a,l;return{caption:null!==(a=null===(n=t.attribute)||void 0===n?void 0:n.formatter.format(e))&&void 0!==a?a:"",value:null!==(l=null==e?void 0:e.toString())&&void 0!==l?l:""}})))&&void 0!==a?a:[]:t.options}),[t.auto,t.attribute,t.options]);e.useEffect((()=>{var e,n,a,l;if(t.multiSelect){if(t.defaultValue){const e=t.defaultValue.split(",").map((e=>g.find((t=>t.value===e)))).filter(Boolean);f(e)}else i(null!==(e=t.emptyOptionCaption)&&void 0!==e?e:"");r(g)}else{const e=[{caption:null!==(n=t.emptyOptionCaption)&&void 0!==n?n:"",value:""},...g],o=null!==(a=e.find((e=>e.value===t.defaultValue)))&&void 0!==a?a:e[0];i(null!==(l=null==o?void 0:o.caption)&&void 0!==l?l:""),c([o]),r(e)}}),[t.defaultValue,g,t.emptyOptionCaption]),e.useEffect((()=>{var e;null===(e=t.updateFilters)||void 0===e||e.call(t,u)}),[u]);const E=0===u.length||a===t.emptyOptionCaption;return e.createElement("div",{className:"dropdown-container","data-focusindex":null!==(n=t.tabIndex)&&void 0!==n?n:0,ref:m},e.createElement("input",{value:E?"":a,placeholder:E?t.emptyOptionCaption:void 0,className:"form-control dropdown-triggerer",onClick:()=>s(!0),onFocus:()=>s(!0),"aria-haspopup":!0,ref:e=>{e&&e.clientWidth&&v(e.clientWidth)},"aria-expanded":d,"aria-controls":"".concat(t.name,"-dropdown-list"),"aria-label":t.ariaLabel}),d&&e.createElement("ul",{id:"".concat(t.name,"-dropdown-list"),className:"dropdown-list",style:{width:p},role:"menu","data-focusindex":0},o.map(((n,a)=>e.createElement("li",{className:l({"filter-selected":!t.multiSelect&&u.includes(n)}),key:a,onClick:()=>h(n),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),h(n))},role:"menuitem",tabIndex:0},t.multiSelect?e.createElement(e.Fragment,null,e.createElement("input",{id:"checkbox_toggle_".concat(a),type:"checkbox",checked:u.includes(n)}),e.createElement("label",{htmlFor:"checkbox_toggle_".concat(a),style:{pointerEvents:"none"}},n.caption)):e.createElement("div",{className:"filter-label"},n.caption))))))}function u(e,t){return"Boolean"===t?"true"!==e&&"false"!==e?e:"true"===e:e}return i.displayName="Alert",function(e){e.Number="number",e.DateTime="datetime"}(o||(o={})),function(n){const a=window["com.mendix.widgets.web.datagrid.filterContext"],l=n.filterOptions.every((({value:e,caption:t})=>"available"===e.status&&"available"===t.status))?n.filterOptions.map((e=>{var t,n;return{caption:null!==(t=e.caption.value)&&void 0!==t?t:"",value:null!==(n=e.value.value)&&void 0!==n?n:""}})):[],o=e.createElement(i,{bootstrapStyle:"danger"},"The data grid drop-down filter widget must be placed inside the header of the Data grid 2.0 widget.");return(null==a?void 0:a.Consumer)?e.createElement(a.Consumer,null,(a=>{var c,d,s;if(!a||!a.filterDispatcher||!a.attribute)return o;const{filterDispatcher:p,attribute:v,initialFilters:m}=a,f=m.map((e=>e.value)).join(","),h=((b=v.type)&&!b.match(/Enum|Boolean/)?"The attribute type being used for Data grid drop-down filter is not 'Boolean or Enumeration'":null)||function(e,t){if(0===t.length)return null;return t.some((t=>{var n;return!(null===(n=e.universe)||void 0===n?void 0:n.includes(u(t.value,e.type)))}))?"There are invalid values available in the Data grid drop-down filter":null}(v,l);var b;return h?e.createElement(i,{bootstrapStyle:"danger"},h):e.createElement(r,{ariaLabel:null===(c=n.ariaLabel)||void 0===c?void 0:c.value,attribute:v,auto:n.auto,defaultValue:f.length>0?f:null===(d=n.defaultValue)||void 0===d?void 0:d.value,emptyOptionCaption:null===(s=n.emptyOptionCaption)||void 0===s?void 0:s.value,multiSelect:n.multiSelect,name:n.name,options:l,tabIndex:n.tabIndex,updateFilters:e=>p({getFilterCondition:()=>function(e,n){if(!e||!e.filterable||0===n.length)return;const{id:a,type:l}=e,i=t.attribute(a);if(n.length>1)return t.or(...n.map((e=>t.equals(i,t.literal(u(e.value,l))))));const[o]=n;if(o.value)return t.equals(i,t.literal(u(o.value,l)));return}(v,e)})})})):o}}));
